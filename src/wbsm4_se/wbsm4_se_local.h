#ifndef WBCRYPTO_WBSM4_SE_LA_LOCAL_H
#define WBCRYPTO_WBSM4_SE_LA_LOCAL_H
#include <WBMatrix/WBMatrix.h>

static const M32 L_matrix = {
        .M[0] = 0xA0202080,
        .M[1] = 0x50101040,
        .M[2] = 0x28080820,
        .M[3] = 0x14040410,
        .M[4] = 0xA020208,
        .M[5] = 0x5010104,
        .M[6] = 0x2808082,
        .M[7] = 0x1404041,
        .M[8] = 0x80A02020,
        .M[9] = 0x40501010,
        .M[10] = 0x20280808,
        .M[11] = 0x10140404,
        .M[12] = 0x80A0202,
        .M[13] = 0x4050101,
        .M[14] = 0x82028080,
        .M[15] = 0x41014040,
        .M[16] = 0x2080A020,
        .M[17] = 0x10405010,
        .M[18] = 0x8202808,
        .M[19] = 0x4101404,
        .M[20] = 0x2080A02,
        .M[21] = 0x1040501,
        .M[22] = 0x80820280,
        .M[23] = 0x40410140,
        .M[24] = 0x202080A0,
        .M[25] = 0x10104050,
        .M[26] = 0x8082028,
        .M[27] = 0x4041014,
        .M[28] = 0x202080A,
        .M[29] = 0x1010405,
        .M[30] = 0x80808202,
        .M[31] = 0x40404101
};

#define GET32(pc)  (\
((uint32_t)(pc)[0] << 24) ^\
((uint32_t)(pc)[1] << 16) ^\
((uint32_t)(pc)[2] <<  8) ^\
((uint32_t)(pc)[3]))

#define PUT32(st, ct)\
(ct)[0] = (uint8_t)((st) >> 24);\
(ct)[1] = (uint8_t)((st) >> 16);\
(ct)[2] = (uint8_t)((st) >>  8);\
(ct)[3] = (uint8_t)(st)

void SE_initial(Aff8 A[2039], Aff8 B[2039]);

#endif 
